# $HeadURL$
# $Id$

Versions
{
  NextRelease
  {
    
  }
  v1r17p5
  {
    Core = co_2011041401
    Interfaces = if_2011050201    
	#CHANGE: if overlayInput runs at CERN, it will get the files with xrdcp
	Workflow = wo_2011051801    
  }
  v1r17p4
  {
    Core = co_2011041401
    Interfaces = if_2011050201    
    #FIX: whizard was throwing an uncaught exception when the lumi was not found
    #CHANGE: OverlayInput will wait no longer than 300 minutes, else declare as failed.
    Workflow = wo_2011051001
  }
  v1r17p3
  { 
    Core = co_2011041401
    Interfaces = if_2011050201
    #FIX: Overlayinput was downloading all files twice!
    Workflow = wo_2011050301
  }
  v1r17p2
  {
    Core = co_2011041401
    #NEW: LCSIM now has a new parameter, extraparams, that can be used to pass command line parameters
    #NEW: GetSRMFile now limits the number of parallel downloads to 100 by default (CS parameter) to avoid time outs from disk server
    #NEW: More messages during overlay input module
    Interfaces = if_2011050201
    Workflow = wo_2011050201
  }
  v1r17p1
  {
    #FIX: OutputREC files and OutputDST were not set properly in LCSIM
    Core = co_2011041401
    #CHANGE: Default Log file name now includes step number, so one can run 2 times or more the same application, and the log file does not get 
    # erased
    #CHANGE: Missing process list message is now a warning.
    Interfaces = if_2011041401
    #Limit the number of concurent OverlayInput steps to a CS parametrisable value (default 200) to limit the load on disks
    Workflow = wo_2011041401
  }
  v1r17p0
  { 
    #CHANGE: add-software script puts the file at IN2P3 and the replication request is to CERN   
    Core = co_2011040701
    #CHANGE: Parameters are now properly placed in the CS
    Interfaces = if_2011040701
    #NEW: Overlay now allows only 200 parallel file downloads, CS parameter
    #CHANGE: Added proper SVN keywords
    Workflow = wo_2011040701
  }
  v1r16p17
  {
    Core = co_2011032901
    Interfaces = if_2011032801
    #BUGFIX: Again the tag name is wrong...
    Workflow = wo_2011033101
  }
  v1r16p16
  {
    Core = co_2011032901
    Interfaces = if_2011032801
    #BUGFIX: Fix logic bug in OverlayInput as it used to download as many files as there are signal events.
    Workflow = wo_2011033011
  }
  v1r16p15
  {
    Core = co_2011032901
    Interfaces = if_2011032801
    #BUGFIX: level of message warning does not exists, but warn does
    Workflow = wo_2011033001
  }
  v1r16p14
  {
    #BUGFIX: USER_spectrum_mode was not set properly in whizard
    Core = co_2011032901
    Workflow = wo_2011032801
    Interfaces = if_2011032801
  }
  v1r16p13
  {
    #CHANGE: Also look at the Number of bunch train to overlay before looking at the files.
    Core = co_2011032801
    Workflow = wo_2011032801
    #NEW:: Support for user spectrum in whizard.
    Interfaces = if_2011032801
  }
  v1r16p12
  {
    Core = co_2011032401
    Interfaces = if_2011032401
	#CHANGE: Disable CPU check while getting the overlay files as there is a risk it takes too much time
	Workflow = wo_2011032501
  }
  v1r16p11
  {
    Core = co_2011032401
    Interfaces = if_2011032401
	#CHANGE: Disable CPU check while getting the overlay files as there is a risk it takes too much time
	Workflo = wo_2011032501
  }
  v1r16p10
  {
    Core = co_2011032401
    Interfaces = if_2011032401
    #BUGFIX: tag number was wrong
    Workflow = wo_2011032401
  }
  v1r16p9
  {
    #NEW: dirac-ilc-add-software and add-whizard now create a replication request for new tar balls.
    Core = co_2011032401
    #NEW: Module to print out the Workflow parameters only
    Interfaces = if_2011032401
    #CHANGE: Now when getting the overlay fioles, wait for 3 minutes on average (gauss distributed, sigma=0.1)
    #CHANGE: Use common method between application modules (not for Mokka though) to report the final status
    #NEW: For next major dirac release, ParametricInputSandbox will be possible with Marlin
    Workflow = wo_20110324011
  }
  v1r16p8
  {
    #NEW: Script to obtain the productions summaries
    #CHANGE: Production API now get the directory metadata to pass to daughters
    Interfaces = if_2011031601
    Core = co_2011031601
    #CHANGE: Catch message in whizard log to declare the job as successful
    Workflow = wo_2011031601
  }
  v1r16p7
  {
    #CHANGE: Get the directorymetadata of the InputData files to get the number of events.
    Core = co_2011030802
    Interfaces = if_2011030401
    Workflow = wo_2011030401
  }
  v1r16p6
  {
    #CHANGE: Look for overlay files only if needed 
    Core = co_2011030801
    Interfaces = if_2011030401
    Workflow = wo_2011030401
  }  
  v1r16p5
  {
    #NEW: Allow setting of event by event parameter ProcessID. Can be set by users' jobs and automatically resolved for production jobs
    Core = co_2011030401
    Interfaces = if_2011030401
    Workflow = wo_2011030401
  }
  v1r16p4
  {
    Interfaces = if_2011030101
    #NEW: Handle the particle.tbl file for Mokka
    Core = co_2011030201
    Workflow = wo_2011030201
  }
  v1r16p3
  {
    Core = co_2011030101
    Interfaces = if_2011030101
    #NEW: Catch the luminosity generated by whizard for a job, and pass it to the workflow_commons definition
    Workflow = wo_2011030101
  }
  v1r16p2
  {
    #FIX: dirac-ilc-add-software
    Core = co_2011022502
    Interfaces = if_2011022401
    Workflow = wo_2011022501
  }
  v1r16p1
  {
    Interfaces = if_2011022401
    #NEW: PrepareTomatoSalad: prepare the xml file for running tomato
    Core = co_2011022501
    #CHANGE: MarlinAnalysis can be subclassed easily: TomatoAnalysis is a subclass
    Workflow = wo_2011022501
  }
  v1r15p7
  {
    #NEW: CheckXMLValidity utility to check at submission time the validity of the xml steering files
    Core = co_2011022401
    #CHANGE: Use new CheckXMLValidity utility for Marlin and LCSIM
    Interfaces = if_2011022401
    Workflow = wo_2011022301
  }
  v1r15p6
  {
    Core = co_2011022301
    #NEW: Switch to ignore application errors, use setIgnoreApplicationErrors() method of ILCJob to enable
    #NEW: validate input xml files during submission, catches most typos.
    Interfaces = if_2011022301
    #CHANGE: allow for user defined LesHouches file if whizard.
    Workflow = wo_2011022301
  }
  v1r15p5
  {
    #FIX: Production API: do not look for detector model if the data type is gen
    Interfaces = if_2011022101
    #CHANGE: Processlist is now passed as inputsandbox, so if downloading fails the first time, the job gets rescheduled
    Core= co_2011022101
    #FIX: SLICAnalysis: outputslcio -> outputFile
    Workflow = wo_2011022101
  }
  v1r15p4
  {
    Core = co_2011021701
    Interfaces = if_2011021701
    #NEW: Registration of production files ancestors
    Workflow = wo_2011021702
  }
  v1r15p3
  {
    #FIX: With new Script interface, our scripts would not work. Made ilc-proxy-init deprecated, use proxy-init instead
    #FIX: Overlay input for LCSIM did not work (created exception)
    Core = co_2011021701
    #NEW: Add MCGeneration as a possible Production type
    Interfaces = if_2011021701
    #CHANGE: Added memory requirement for java in LCSIM
    Workflow = wo_2011021701 
  }
  v1r15p2
  {
    Core = co_2011021601
    Interfaces = if_2011021601
    #FIX: bad workflow tag
    Workflow= wo_2011021602
  }
  v1r15p1
  {
    Core = co_2011021601
    Interfaces = if_2011021601
    #FIX: bad workflow tag
    Workflow= wo_2011021602
  }
  v1r15p0
  #CHANGE: move to DIRAC v5r12p7
  {
    #NEW: Utility to obtain a prod proxy if needed, useful in prod submission scripts
    Core= co_2011021601
    #CHANGE: Modified scripts for sid jobs
    #NEW: support for Tomato, check collections, lcio concat: currently in test phase
    Interfaces= if_2011021601
    #CHANGE: Moved many parameters from many sub classes to mother class (ModuleBase): easier maintenance
    #NEW: Support for overlay in LCSIM
    Workflow= wo_2011021601
  }
  v1r14p0
  {
    #CHANGE: software addition uses Request object for replication.
    #FIX: now remove system libs from all application on site. In the future, should remove them at tar ball creation time
    Core = co_2011020701
    #NEW: SID production submission scripts
    #NEW: SID chain job submission scripts, and directory containing necessary files
    Interfaces=if_2011020701
    #FIX: Pass basename of xml file in LCSIM instead of parameter value
    Workflow =wo_2011020701
  }
  v1r13p3
  {
    #FIX: Gear file can also be a text in the xml parameters, not only a value
    Core = co_2011013101
    Interfaces = if_2011012801
    Workflow = wo_2011012801    
  }
  v1r13p2
  {
    #NEW: Added utilities for overlay input
    Core = co_2011012801
    #NEW: interface for overlay
    Interfaces = if_2011012801
    #NEW: Module for Overlay Input
    #FIX: fix import location in LCSIMAnalysis
    Workflow = wo_2011012801
  }
  v1r13p1
  {
    Core=co_2011012701
    Interfaces=if_2011012701
    #FIX: fix LD_LIBRARY_PATH for whizard
    Workflow=wo_2011012702
  }
  v1r13p0 
  {
    #NEW: Utility to remove the libc provided in the software packages
    Core=co_2011012701
    #NEW: Script to submit productions in slic context
    Interfaces=if_2011012701
    #CHANGE: All worflow modules check that log file is present
    Workflow=wo_2011012701
  }
  v1r12p1 
  {
    Core = co_2011012101
    Interfaces = if_2011012101
    #FIX: bug fix in MokkaAnalysis
    Workflow = wo_2011012102
  }
  v1r12p0 
  {
    #NEW: Now Mokka uses random seed for every job. Users can set their own seed.
    Core = co_2011012101
    Interfaces = if_2011012101
    Workflow = wo_2011012101
  }
  v1r11p2
  {
    #DELETE: do not need Configuration anymore
    Core = co_2010122002
    Interfaces = if_2010122002
    #FIX: take new interface of writestdhep into account
    Workflow = wo_2010122101
  }
  v1r11p1
  {
    Configuration = cs_2010072201
    #FIX: Bug in CombimedSoftware installation
    Core = co_2010122002
    #FIX: Several errors remained in PostGenSel module
    Interfaces = if_2010122002
    Workflow = wo_2010122002
  }
  v1r11p0
  {
    Configuration = cs_2010072201
    
    #NEW: added script to obtain list of available software: no need to use web page
    Core = co_2010122001
    
    #NEW: added PostGenSel step to allow "generator level" cuts
    Interfaces = if_2010122001
    Workflow =  wo_2010122001
    
  }
  v1r10p7
  {
    Configuration = cs_2010072201
  
    #CHANGE: All applications are also replicated to IN2P3-SRM
    Core = co_2010121301
    #CHANGE: jobindex in whizard can be anything
    #FIX: XML file for LCSIM is now a parameter in the Production API 
    Interfaces = if_2010121301
    #CHANGE: in whizard, when PYSTOP was called, application was still OK, now not anymore
    Workflow = wo_2010121301
  }
  v1r10p6
  {
    Configuration = cs_2010072201

    #FIX: TARSoft was failing installation of lcio
    Core = co_2010120802 
    
    Interfaces = if_2010120801
    
    Workflow = wo_2010120801
  }
  v1r10p5
  {
    Configuration = cs_2010072201

    #NEW: LCIO specific install: environment vars are set
    Core = co_2010120801 
    
    #CHANGE: Allowed models in Whizard for susy are slsqhh and chne
    Interfaces = if_2010120801
    
    #FIXME: bug fix in ApplicationScript
    Workflow = wo_2010120801
  }
  v1r10p4
  {
    Configuration = cs_2010072201
    Core = co_2010120101
    
    #NEW: allow choice of SUSY model in whizard
    Interfaces = if_2010120102
    Workflow =  wo_2010120101
  }
  v1r10p3
  {
    Configuration = cs_2010072201
    #CHANGE: added beam_ercoil and keep_initials as parameters
    Core = co_2010120101
    Interfaces = if_2010120101
 
    Workflow =  wo_2010112601

  }
  v1r10p2
  {
    Configuration = cs_2010072201
    Core = co_2010112501
    Interfaces = if_2010112401

    #FIX: Registration of file in FC failed because FC changed
    Workflow =  wo_2010112601
  }
  v1r10p1
  {
    Configuration = cs_2010072201
    
    #FIX: PrepareOptionsFile had a bug in Preparation of whizard.in
    Core = co_2010112501
    
    Interfaces = if_2010112401
    Workflow =  wo_2010112401
  }
  v1r10p0
  {
    Configuration = cs_2010072201

    #CHANGE: Whizard default .in file is now whizard.template.in, and is templated
    #CHANGE: Propagate the number of events and luminosity through productions
    Core = co_2010112401
    
    #NEW: Whizard step in DIRAC
    #CHANGE: Production and user job API takes parameters for whizard, to fill in the template
    #CHANGE: complete LCSIM step in production API: input and output are treated properly
    #CHANGE: Production details are available from web interface
    #NEW: SLIC Pandora step is in ProductionAPI
    Interfaces = if_2010112401
    
    #NEW: WhizardAnalysis module
    #CHANGE: UserLFN now uses current credentials to guess the VO: suitable for ILC and CALICE run
    #NEW: FailoverRequest module: publish requests and update file status in transformation system
    Workflow =  wo_2010112401
  }
  v1r9p0
  {
    Configuration = cs_2010072201

    # NEW: add resolveOFnames to change output files in production context
    # CHANGE: check that application software is not empty after untarring
    # NEW: script/dirac-ilc-add-whizard: define in DIRAC a new whizard version
    Core = co_2010102801
    
    # CHANGE: allow arguments in ApplicationScript. To be used for pyroot scripts
    # CHANGE: add IS_PROD to workflow parameters, for Production API only
    # NEW: Add possibility to get a file using its SRM path
    # FIXME: startFrom in mokka is 0 by default instead of 1.
    # NEW: SLICPandora step definition 
    Interfaces = if_2010102801

    # CHANGE: handle production context properly: input and output file names depend on prod ID and job ID
    # CHANGE: check that applications are actually there before running, and if not return an error.
    # NEW: GetSRMFile module: used to get a file given its SRM path. Useful to get a file that is not registered in the DIRAC FC.
    # NEW: RegisterOutputData: set the metadata flags for production data 
    # NEW: SLICPandora Module
    Workflow = wo_2010102801
  }

  v1r7p1
  {
    Configuration = cs_2010072201
     
    # CHANGE: add comments in created steering and xml
    # TODO: idem for SLIC and LCIM
    # FIXME: replace rstrip by replace in TARSoft.py
    Core = co_2010072601
    
    # CHANGE: Marlin does not need to be specified the inputslcio list, as it is taken from inputdata if mokka step is not run before
    # CHANGE: overload setBannedSites
    Interfaces = if_2010072601
    
    # FIXME: fix type error in MarlinAnalysis
    Workflow = wo_2010072601
  }
  
  v1r7p0
  {
    # FIXME: In UsersAndGroups, fix invalid import and method
    Configuration = cs_2010072201
    
    # CHANGE: In presubmissionchecks, check that outputpath, if used, does not contain /../, /./, or //, and does not end with /.
    # CHANGE: All applications now call the UserJobFinalization module, and setOutputData is ILC specific.
    # CHANGE: Check that outputdata and outputsandbox do not contain the same things and output data does not allow wildcard
    # FIXME: checks where not done properly, all things were not checked
    # FIXME: add TotalSteps in setROOT
    # CHANGE: allow to use LFNs for steering and xml files for Mokka and Marlin
    Interfaces = if_2010072201

  	# CHANGE: Reshuffle CombinedSoftwareInstallation so that we use the SharedArea
	# CHANGE: TARSoft: don't redownload the applications if they are already there. Had to do some tricks to manage slic folder name
	# TODO: what about LCSIM
  	# CHANGE: in TARSoft, use ReplicaManager if url does not start with http://
	# CHANGE: better check in SQLWrapper that TMP dir is properly created. Also do proper remove of TMP dir, whatever happened to the socket.
  	# CHANGE: better handling of SQLWrapper errors
  	# CHANGE: Add modules needed by UserJobFinalization
  	# CHANGE: adapt ProdutionData to ILC needs, basically removing everything
  	# CHANGE: To be able to use InputData, need to import InputDataResolution.
  	# CHANGE: dirac-ilc-add-sofware.py: now add to TarBallURL location the tar ball
  	# CHANGE: update detectOS after discussion with Hubert, comment out slc4 binary support
	Core = co_2010072202

	# CHANGE: handle return value of SQLWrapper in MokkaWrapper
	# CHANGE: check if input slcio is present for Marlin before running
	# CHANGE: add UserJobFinalization module, taken from LHCb
	# CHANGE: prepare for using InputData: find out where the files are on the fly and pass the full path to PrepareOptionsfiles
	Workflow = wo_2010072201
  }
  
  v1r6p2
  {
  # FIXME: tag was badly done, incorrect directory structure  
  ConfigurationSystem = cs_2010060201
  # FIXME: tag was badly done, incorrect directory structure 
  Interfaces = if_2010060202
  # FIXME: tag was badly done, incorrect directory structure 
  Core = co_2010060202
  # FIXME: tag was badly done, incorrect directory structure 
  Workflow = wo_2010060202
  # FIXME: tag was badly done, incorrect directory structure 
  DataManagementSystem = dm_2010060201
  }
  v1r6p1
  {
  ConfigurationSystem = cs_2010021501
  Interfaces = if_2010060201
  # FIXME: Core tag name was badly formed
  Core = co_2010060201
  Workflow = wo_2010060201
  DataManagementSystem = dm_2010041901
  }
  v1r6p0
  {
  	ConfigurationSystem = cs_2010021501
  	
    # FIXME: don't check if input gen file is local if it starts with LFN:
    # CHANGE: use elif statements
    Interfaces = if_2010060201
  
  	# FIXME: use try, except when untarring, allows for catching errors in tar ball, like CRC checks
  	# NEW: dirac-ilc-add-software, utility to add software in CS
  	Core = co_2910060201
  	
    # FIXME: SLIC, allow for multiple detector model sources
    # FIXME: in MokkaAnalysis, the provided gen file was never used
    # FIXME: idem, but outputFile was not used
    # FIXME: in lcsimanalysis, copy the alias.properties files only if specified
    # CHANGE: handle end of file reached in Mokka, avoid job declared as failed.
    # CHANGE: in Marlin if nb of events to process is not specified, use -1 i.e. all events.
    Workflow = wo_2010060201
    
    DataManagementSystem = dm_2010041901
  }
  
  v1r5p0
  {
	ConfigurationSystem = cs_2010021501
	
	# FIXME: in PrepareOptionFiles, fix case where no LCIOinputFile can be found in input xml
	# FIXME: idem, repair broken lcsim file
	# CHANGE: Take into account dependencies in installation phase.
	# CHANGE: Set convention that folder containing application is same as tar ball name minus .tar.gz and .tgz
	Core = co_2010050301

	# FIXME: Did not use input lcio in LCSIM
	Interfaces = if_2010050301

	# CHANGE: Get base folder  name based on CS content, allows for multiple version of the same software to run
	# FIXME: Running marlin: duplicated processors were not properly removed from MARLIN_DLL.
	Workflow = wo_2010050301
	
	DataManagementSystem = dm_2010041901
  }

  v1r4p0
  {
	ConfigurationSystem = cs_2010021501
	
	# CHANGE: add in PrepareOptionsFiles the relevant methods for SLIC and LCSIM
	# FIXME: fixes to the methods for Mokka and Marlin.
	Core = co_2010041901
	
	# CHANGE: add the relevant bits of code for the definition of SLIC and LCSIM jobs
	# CHANGE: add the possibility to run on mac files in mokka
	# NEW: add DiracILC with specification of preSubmissionChecks
	Interfaces = if_2010041901
	
	# CHANGE: add relevant workflow for SLIC and LCSIM
	Workflow = wo_2010041901

    # NEW: add DataManagementSystem, for dirac-dms-gridify-castor-file script
    DataManagementSystem = dm_2010041901
    
  }
  v1r3p0
  {
    ConfigurationSystem = cs_2010021501

	# CHANGE: add ilc-install.sh script 
	# FIXME: Fix PrepareOptions such that the parsing of options is done properly
	Core = co_2010033101
	
	# CHANGE: in ILCJob, possibility to run Mokka and Marlin in one job
    Interfaces = if_2010033101

    # FIXME: Finalize MokkaAnalysis and MarlinAnalysis
    Workflow = wo_2010033101
  }

  v1r2p0
  {
    ConfigurationSystem = cs_2010021501

    # FIXME: Correct passing options to WMS
    Interfaces = if_2010031501
    
    # FIXME: Fix MarlinAnalysis and MokkaAnalysis. In MokkaAnlysis, don't use mokka-wrapper.sh
    Workflow = wo_2010031501
    
    # CHANGE: rewrite of SQLwrapper
    Core = co_2010031501
  }
  
  v1r1p0
  {
   	# CHANGE: adapt UsersAndGroups to LCD : comment references to LFC
    ConfigurationSystem = cs_2010021501
    
    # CHANGE: finish dev of LCDJob
    Interfaces = if_2010022601
    
    # BUGFIX: Fix several bugs
    Workflow = wo_2010022601
    
    # CHANGE: start working on InputDataResolution
    Core = co_2010022601
  }
  
  # NEW: first release
  v1r0p0
  {
    # NEW: first import
    ConfigurationSystem = cs_2010021001

    # NEW: first import
    Core = co_2010021001
    
    # NEW: first import
    Interfaces = if_2010021001

    # NEW: first import
    Workflow = wo_2010021001
  }
}  